

var skill20 = [2290000,2290002,2290004,2290006,2290008,2290010,2290012,2290014,2290016,2290018,2290019,2290020,2290022,2290024,2290026,2290028,2290030,2290032,2290034,2290036,2290038,2290040,2290042,2290044,2290046,2290048,2290050,2290052,2290054,2290056,2290058,2290060,2290062,2290064,2290066,2290068,2290070,2290072,2290074,2290076,2290078,2290080,2290082,2290084,2290086,2290088,2290090,2290092,2290094,2290096,2290097,2290099,2290101,2290102,2290104,2290106,2290108,2290110,2290112,2290114,2290115,2290117,2290119,2290121,2290123,2290124,2290126,2290128,2290130,2290132,2290134,2290136,2290138,2290140,2290142,2290144,2290146,2290148,2290150,2290151,2290153,2290154,2290155,2290156,2290165,2290166,2290167,2290168,2290171,2290172,2290173,2290174,2290177,2290178,2290179,2290180,2290183,2290184,2290185,2290186,2290189,2290190,2290191,2290192,2290195,2290196,2290197,2290198,2290199,2290200,2290201,2290204,2290205,2290206,2290226,2290228,2290230,2290232,2290234,2290236,2290238,2290240,2290242,2290244,2290246,2290248,2290249,2290250,2290251,2290254,2290255,2290256,2290257,2290260,2290263,2290266,2290269,2290272,2290273,2290274,2290275,2290277,2290279,2290281,2290282,2290284,2290286,2290287,2290288,2290289,2290290,2290292,2290322,2290324,2290326,2290328,2290329,2290331,2290333,2290340,2290342,2290343,2290345,2290347,2290349,2290354,2290356,2290358,2290359,2290361,2290363,2290364,2290366,2290370,2290378,2290393,2290395,2290397,2290398,2290400,2290409];
var skill30 = [2290001,2290003,2290005,2290007,2290009,2290011,2290013,2290015,2290017,2290021,2290023,2290025,2290027,2290029,2290031,2290033,2290035,2290037,2290039,2290041,2290043,2290045,2290047,2290049,2290051,2290053,2290055,2290057,2290059,2290061,2290063,2290065,2290067,2290069,2290071,2290073,2290075,2290077,2290079,2290081,2290083,2290085,2290087,2290089,2290091,2290093,2290095,2290098,2290100,2290103,2290105,2290107,2290111,2290113,2290116,2290118,2290120,2290122,2290125,2290127,2290129,2290131,2290133,2290135,2290137,2290139,2290141,2290143,2290145,2290147,2290149,2290152,2290157,2290158,2290159,2290160,2290161,2290168,2290169,2290170,2290174,2290175,2290176,2290180,2290181,2290182,2290186,2290187,2290188,2290192,2290193,2290194,2290207,2290227,2290229,2290231,2290233,2290235,2290237,2290239,2290241,2290243,2290247,2290251,2290252,2290253,2290257,2290258,2290259,2290260,2290261,2290262,2290263,2290264,2290266,2290267,2290268,2290269,2290270,2290271,2290276,2290278,2290280,2290283,2290291,2290293,2290294,2290295,2290296,2290297,2290298,2290299,2290300,2290301,2290302,2290303,2290304,2290305,2290306,2290307,2290308,2290309,2290310,2290311,2290312,2290313,2290314,2290315,2290316,2290317,2290318,2290319,2290320,2290321,2290323,2290325,2290327,2290330,2290332,2290334,2290335,2290336,2290337,2290338,2290339,2290341,2290344,2290346,2290348,2290350,2290351,2290352,2290353,2290355,2290357,2290360,2290362,2290365,2290367,2290368,2290369,2290371,2290372,2290373,2290374,2290375,2290376,2290377,2290379,2290380,2290381,2290382,2290383,2290384,2290385,2290386,2290387,2290388,2290389,2290390,2290391,2290392,2290394,2290396,2290399,2290401,2290402,2290403,2290404,2290405,2290406,2290407,2290408,2290410,2290411];


var icon1 = "#fEffect/ItemEff/004/0#"; //黃驚嘆
var icon5 = "#fEffect/ItemEff/0/10#";
var icon2 = "#fUI/UIWindow/Quest/icon1#"; //灰驚嘆
var icon3 = "#fEffect/ItemEff/004/1#";
var icon4 = "#fUI/UIWindow/Quest/icon7/8#"; //限時
var cake = "#fEffect/ItemEff/0/9#";
var get = "#fEffect/ItemEff/004/3#";
var need = "#fEffect/ItemEff/004/4#";

var status;
var change = 4036657;
var count20 = 20;
var count30 = 50;

function start(){
	status = -1;
	action(1,0,0);
}




function action(mode, type, selection) {
    if (mode == 1) {
        status++;
    } else {
        status--;
    }
	if(mode == 0){
		cm.dispose();
	}
	
    if (status == 0) {
		var msg = "#e";
		msg += icon5 + " #d技能書兌換專區#k\r\n";
		msg += icon1 + " 兌換技能書需要物品 : #i" + change + "# #z" + change + "#\r\n";
		msg += "#L0#" + icon3 + " #b兌換#k #r20#k #b技能書#k\r\n";
		msg += "#L1#" + icon3 + " #b兌換#k #r30#k #b技能書#k\r\n";
		cm.sendSimple(msg);
	}else if(status == 1){
		this. sel = selection;
		if(sel < 0){
			cm.dispose();	
		}else if(sel == 0){
			var msg = "#e#b兌換20技能書需要 #k#r" + count20 + "#k #b個 #i" + change + "##k\r\n";
			for(var i = 0 ; i < skill20.length ; i++){
				msg += "#L" + i + "#" + icon3 + " #d兌換#k #r#z" + skill20[i] + "##k\r\n";
			}
			cm.sendSimple(msg);
		}else if(sel == 1){
			var msg = "#e#b兌換30技能書需要 #k#r" + count30 + "#k #b個 #i" + change + "##k\r\n";
			for(var x = 0 ; x < skill30.length ; x++){
				msg += "#L" + x + "#" + icon3 + " #d兌換#k #r#z" + skill30[x] + "##k\r\n";
			}
			cm.sendSimple(msg);
		}
	}else if(status == 2){
		this. p = selection;
		if(sel == 0){
			cm.sendYesNo("#b#e確定要兌換 #k#r#z" + skill20[p] + "##k #b嗎?#k");
		}else if(sel == 1){
			cm.sendYesNo("#b#e確定要兌換 #k#r#z" + skill30[p] + "##k #b嗎?#k");
		}
		
	}else if(status == 3){
		var q = cm.getPlayer().itemQuantity(change);
		if(sel == 0){
			if(q < count20){
				cm.sendOk("#e您的兌換物品不足!");
				cm.dispose();
			}else{
				cm.gainItem(skill20[p],1);
			    cm.gainItem(change,-count20);
				cm.sendOk("#e謝謝您的兌換!祝你成功!");
				cm.dispose();
			}
			
		}else if(sel == 1){
			if(q < count30){
				cm.sendOk("#e您的兌換物品不足!");
				cm.dispose();
			}else{
				cm.gainItem(skill30[p],1);
			    cm.gainItem(change,-count30);
				cm.sendOk("#e謝謝您的兌換!祝你成功!");
				cm.dispose();
			}
		}
		
	}
}